<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="520" viewBox="0 0 900 520">
  <defs>
    <linearGradient id="inputGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#43A047;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2E7D32;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="hiddenGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F7C948;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E5A823;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="outputGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#E53935;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#C62828;stop-opacity:1" />
    </linearGradient>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="currentColor">CBOW: Continuous Bag of Words</text>
  <text x="450" y="58" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#666">Predict the target word from its context words</text>

  <!-- Example sentence -->
  <g transform="translate(100, 85)">
    <text x="350" y="0" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" fill="#666">Example: "The quick brown fox jumps over the lazy dog"</text>

    <g transform="translate(80, 20)">
      <rect x="0" y="0" width="50" height="28" rx="4" fill="#E8F5E9" stroke="#43A047" stroke-width="1.5"/>
      <text x="25" y="19" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2E7D32">quick</text>

      <rect x="60" y="0" width="55" height="28" rx="4" fill="#E8F5E9" stroke="#43A047" stroke-width="1.5"/>
      <text x="87" y="19" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2E7D32">brown</text>

      <rect x="125" y="0" width="40" height="28" rx="4" fill="#FFCDD2" stroke="#E53935" stroke-width="2"/>
      <text x="145" y="19" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#C62828">fox</text>
      <text x="145" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#C62828">target</text>

      <rect x="175" y="0" width="55" height="28" rx="4" fill="#E8F5E9" stroke="#43A047" stroke-width="1.5"/>
      <text x="202" y="19" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2E7D32">jumps</text>

      <rect x="240" y="0" width="45" height="28" rx="4" fill="#E8F5E9" stroke="#43A047" stroke-width="1.5"/>
      <text x="262" y="19" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2E7D32">over</text>
    </g>
  </g>

  <!-- Neural Network Architecture -->
  <!-- Input Layer (Context Words) -->
  <g id="input-layer">
    <text x="130" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2E7D32">Context Words</text>
    <text x="130" y="192" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">(One-hot vectors)</text>

    <rect x="70" y="210" width="120" height="40" rx="5" fill="url(#inputGrad)"/>
    <text x="130" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" fill="white">quick</text>

    <rect x="70" y="265" width="120" height="40" rx="5" fill="url(#inputGrad)"/>
    <text x="130" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" fill="white">brown</text>

    <rect x="70" y="320" width="120" height="40" rx="5" fill="url(#inputGrad)"/>
    <text x="130" y="345" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" fill="white">jumps</text>

    <rect x="70" y="375" width="120" height="40" rx="5" fill="url(#inputGrad)"/>
    <text x="130" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" fill="white">over</text>
  </g>

  <!-- Connections: Input to Hidden -->
  <g opacity="0.5">
    <line x1="190" y1="230" x2="350" y2="310" stroke="#888" stroke-width="1.5"/>
    <line x1="190" y1="285" x2="350" y2="310" stroke="#888" stroke-width="1.5"/>
    <line x1="190" y1="340" x2="350" y2="310" stroke="#888" stroke-width="1.5"/>
    <line x1="190" y1="395" x2="350" y2="310" stroke="#888" stroke-width="1.5"/>
  </g>

  <!-- Projection/Hidden Layer -->
  <g id="hidden-layer">
    <text x="420" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#E5A823">Projection Layer</text>
    <text x="420" y="192" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">(Average of embeddings)</text>

    <rect x="350" y="250" width="140" height="120" rx="8" fill="url(#hiddenGrad)"/>
    <text x="420" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">Average</text>
    <text x="420" y="315" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">Context</text>
    <text x="420" y="335" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">Vector</text>
    <text x="420" y="358" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#555">(d dimensions)</text>
  </g>

  <!-- Connections: Hidden to Output -->
  <g opacity="0.5">
    <line x1="490" y1="310" x2="620" y2="310" stroke="#888" stroke-width="1.5"/>
  </g>

  <!-- Output Layer -->
  <g id="output-layer">
    <text x="710" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#C62828">Output Layer</text>
    <text x="710" y="192" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">(Softmax over vocabulary)</text>

    <rect x="620" y="220" width="180" height="180" rx="8" fill="#FFEBEE" stroke="#E53935" stroke-width="2"/>

    <text x="710" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">P(the) = 0.01</text>
    <text x="710" y="270" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">P(quick) = 0.02</text>
    <text x="710" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">...</text>
    <rect x="640" y="300" width="140" height="25" rx="4" fill="#E53935"/>
    <text x="710" y="317" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">P(fox) = 0.85</text>
    <text x="710" y="345" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">...</text>
    <text x="710" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">P(dog) = 0.03</text>
    <text x="710" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">P(lazy) = 0.01</text>
  </g>

  <!-- Arrows with labels -->
  <g transform="translate(250, 295)">
    <line x1="0" y1="15" x2="80" y2="15" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="40" y="5" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">W (V×d)</text>
  </g>

  <g transform="translate(510, 295)">
    <line x1="0" y1="15" x2="90" y2="15" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="45" y="5" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">W' (d×V)</text>
  </g>

  <!-- Key insight box -->
  <rect x="100" y="440" width="700" height="60" rx="8" fill="#E3F2FD" stroke="#1976D2" stroke-width="2"/>
  <text x="450" y="465" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565C0">CBOW Training Objective</text>
  <text x="450" y="487" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" fill="#333">Maximize P(target | context) = P(fox | quick, brown, jumps, over)</text>
</svg>
